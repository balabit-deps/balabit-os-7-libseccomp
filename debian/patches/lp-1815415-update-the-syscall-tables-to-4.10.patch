From 116b3c1a2e1db53cc35b74f30c080f5265faa674 Mon Sep 17 00:00:00 2001
From: Paul Moore <paul@paul-moore.com>
Date: Thu, 2 Feb 2017 18:30:44 -0500
Subject: [PATCH] arch: update the syscall tables to 4.10-rc6+

Signed-off-by: Paul Moore <paul@paul-moore.com>

Origin: upstream, https://github.com/seccomp/libseccomp/commit/116b3c1a2e1db53cc35b74f30c080f5265faa674
Bug-Ubuntu: https://bugs.launchpad.net/bugs/1815415
Last-Update: 2019-02-10

---
 src/arch-aarch64-syscalls.c | 12 ++++++------
 src/arch-ppc-syscalls.c     |  4 ++--
 src/arch-ppc64-syscalls.c   |  4 ++--
 3 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/src/arch-aarch64-syscalls.c b/src/arch-aarch64-syscalls.c
index 84f5d60..d907182 100644
--- a/src/arch-aarch64-syscalls.c
+++ b/src/arch-aarch64-syscalls.c
@@ -26,7 +26,7 @@
 #include "arch.h"
 #include "arch-aarch64.h"
 
-/* NOTE: based on Linux 4.9 */
+/* NOTE: based on Linux 4.10-rc6+ */
 const struct arch_syscall_def aarch64_syscall_table[] = { \
 	{ "_llseek", __PNR__llseek },
 	{ "_newselect", __PNR__newselect },
@@ -254,15 +254,15 @@ const struct arch_syscall_def aarch64_syscall_table[] = { \
 	{ "pipe", __PNR_pipe },
 	{ "pipe2", 59 },
 	{ "pivot_root", 41 },
-	{ "pkey_alloc", __PNR_pkey_alloc },
-	{ "pkey_free", __PNR_pkey_free },
-	{ "pkey_mprotect", __PNR_pkey_mprotect },
+	{ "pkey_alloc", 289 },
+	{ "pkey_free", 290 },
+	{ "pkey_mprotect", 288 },
 	{ "poll", __PNR_poll },
 	{ "ppoll", 73 },
 	{ "prctl", 167 },
 	{ "pread64", 67 },
 	{ "preadv", 69 },
-	{ "preadv2", 392 },
+	{ "preadv2", 286 },
 	{ "prlimit64", 261 },
 	{ "process_vm_readv", 270 },
 	{ "process_vm_writev", 271 },
@@ -273,7 +273,7 @@ const struct arch_syscall_def aarch64_syscall_table[] = { \
 	{ "putpmsg", __PNR_putpmsg },
 	{ "pwrite64", 68 },
 	{ "pwritev", 70 },
-	{ "pwritev2", 393 },
+	{ "pwritev2", 287 },
 	{ "query_module", __PNR_query_module },
 	{ "quotactl", 60 },
 	{ "read", 63 },
diff --git a/src/arch-ppc-syscalls.c b/src/arch-ppc-syscalls.c
index 85570bd..c117da9 100644
--- a/src/arch-ppc-syscalls.c
+++ b/src/arch-ppc-syscalls.c
@@ -27,7 +27,7 @@
 #include "arch.h"
 #include "arch-ppc.h"
 
-/* NOTE: based on Linux 4.9 */
+/* NOTE: based on Linux 4.10-rc6+ */
 const struct arch_syscall_def ppc_syscall_table[] = { \
 	{ "_llseek", 140 },
 	{ "_newselect", 142 },
@@ -177,7 +177,7 @@ const struct arch_syscall_def ppc_syscall_table[] = { \
 	{ "ioprio_set", 273 },
 	{ "ipc", 117 },
 	{ "kcmp", 354 },
-	{ "kexec_file_load", __PNR_kexec_file_load },
+	{ "kexec_file_load", 382 },
 	{ "kexec_load", 268 },
 	{ "keyctl", 271 },
 	{ "kill", 37 },
diff --git a/src/arch-ppc64-syscalls.c b/src/arch-ppc64-syscalls.c
index 47cb56c..bbd5876 100644
--- a/src/arch-ppc64-syscalls.c
+++ b/src/arch-ppc64-syscalls.c
@@ -27,7 +27,7 @@
 #include "arch.h"
 #include "arch-ppc64.h"
 
-/* NOTE: based on Linux 4.9 */
+/* NOTE: based on Linux 4.10-rc6+ */
 const struct arch_syscall_def ppc64_syscall_table[] = { \
 	{ "_llseek", 140 },
 	{ "_newselect", 142 },
@@ -177,7 +177,7 @@ const struct arch_syscall_def ppc64_syscall_table[] = { \
 	{ "ioprio_set", 273 },
 	{ "ipc", 117 },
 	{ "kcmp", 354 },
-	{ "kexec_file_load", __PNR_kexec_file_load },
+	{ "kexec_file_load", 382 },
 	{ "kexec_load", 268 },
 	{ "keyctl", 271 },
 	{ "kill", 37 },
-- 
2.17.1

